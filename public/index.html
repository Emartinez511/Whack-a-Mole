<!DOCTYPE html>
<html>
<head>
    <title>Whack a Mole</title>
    <link rel="stylesheet" href="/css/css_mole.css">
</head>
<body>
    <h1><img src="/img/logo.png"></h1>
    <div id="game_box">
        <div id="square1" class="square"><img id="caddy1" class="popUp" src="caddy.png" /></div>
        <div id="square2" class="square"><img id="caddy2" class="popUp" src="caddy.png" /></div>
        <div id="square3" class="square"><img id="caddy3" class="popUp" src="caddy.png" /></div>
        <div id="square4" class="square"><img id="caddy4" class="popUp" src="caddy.png" /></div>
        <div id="square5" class="square"><img id="caddy5" class="popUp" src="caddy.png" /></div>
        <div id="square6" class="square"><img id="caddy6" class="popUp" src="caddy.png" /></div>
        <div id="square7" class="square"><img id="caddy7" class="popUp" src="caddy.png" /></div>
        <div id="square8" class="square"><img id="caddy8" class="popUp" src="caddy.png" /></div>
        <div id="square9" class="square"><img id="caddy9" class="popUp" src="caddy.png" /></div>
    </div>
    <div class="button_box">
        <div><img src="/img/score.png"></div>    
        <button id="start"><img src="/img/start.png"></button>
        <p id="score"></p>
        <p id="time_logo"><img src="/img/timer.png"></p>
        <p id="timer">30</p>
    </div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script>
(function(){
 "use strict"
    var molesClick= [];
    var $square = $(".popUp")
    var score = 0;
    var detonationTimer = 0;

    // THIS IS THE START BUTTON
    $("#start").click (function(){
        detonationTimer = 30;
        score = 0;
        startGame();

    });


    // This start the beginning function
    function startGame() {
        if (detonationTimer > 0){
            molesClick = [];
            randomNumber();
            play();   
        }
    };
    

        function updateTimer(){
                $('#timer').text(detonationTimer);
            if (detonationTimer === 0) {
                alert('GAME OVER');
                clearInterval();
            } 

            detonationTimer--;

        };

   function randomNumber() {
        var random = Math.floor(Math.random() * $(".square").length);
        var molePop = $square[random];
        var id = molePop.id;
        molesClick.push(id);
    };


    function play () {
        $("#score").text(score);
        var intervalId = setInterval(myTimer, 1000);
        var timer = setTimeout(updateTimer, 1000);
        function myTimer(){
            moleShow($("#" + molesClick));
            clearInterval(intervalId);
            startGame();
        };
    };

    $square.click(function() {
        if ($(this).has( "img" ).css( "display", "block" )) {
            $(this).css("display", "none");
            score++;
        } 
    });
       
    function moleShow (square) {
        square.css("display", "block");
        setTimeout(function () {
            square.css("display", "none");
        }, 2000);
        }

 })();
 </script>
</body>
</html>